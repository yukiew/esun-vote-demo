(function(){"use strict";var e={9180:function(e,t,a){var n=a(6369),d=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"root"}},[t("div",{staticClass:"candidate-container"},[t("div",{staticClass:"candidate-wrap"},[t("MyHeader",{attrs:{addCandidate:e.addCandidate},on:{toggleMode:e.toggleMode}}),t("MyList",{attrs:{candidates:e.candidates,checkCandidate:e.checkCandidate,deleteCandidate:e.deleteCandidate,isAdmin:e.isAdmin}}),t("MyFooter",{attrs:{candidates:e.candidates,checkAllCandidate:e.checkAllCandidate,clearAllCandidate:e.clearAllCandidate,isAdmin:e.isAdmin}})],1)])])},i=[],s=a(4161),r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"candidate-header"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],attrs:{type:"text",placeholder:"請輸入要新增的投票項目，並按下Enter確認",disabled:"使用者模式"===e.mode},domProps:{value:e.name},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.add.apply(null,arguments)},input:function(t){t.target.composing||(e.name=t.target.value)}}}),t("button",{staticClass:"btn btn-primary",on:{click:e.toggleMode}},[e._v(e._s(e.mode))])])},o=[],c=a(691),l={name:"MyHeader",props:["addCandidate"],data(){return{name:"",mode:"使用者模式"}},methods:{async add(){if(!this.name.trim())return alert("輸入不能為空");const e={id:(0,c.x0)(),name:this.name,selected:!1,count:0};try{await s.Z.post("/candidate/create",e),this.addCandidate(e),this.name=""}catch(t){console.error("添加投票項目失敗",t)}},toggleMode(){this.mode="使用者模式"===this.mode?"管理員模式":"使用者模式",this.$emit("toggleMode",this.mode)}}},u=l,h=a(1001),m=(0,h.Z)(u,r,o,!1,null,"53c5b96d",null),p=m.exports,f=function(){var e=this,t=e._self._c;return t("ul",{staticClass:"candidate-main"},e._l(e.localCandidates,(function(a){return t("MyItem",{key:a.id,attrs:{candidate:a,checkCandidate:e.checkCandidate,deleteCandidate:e.deleteCandidate,isAdmin:e.isAdmin},on:{delete:e.handleDelete}})})),1)},v=[],C=function(){var e=this,t=e._self._c;return t("li",[t("label",[t("input",{attrs:{type:"checkbox",disabled:e.isAdmin},domProps:{checked:e.candidate.selected},on:{change:function(t){return e.handleCheck(e.candidate.id)}}}),t("span",[e._v(e._s(e.candidate.name))]),t("span",{staticClass:"count"},[e._v("票數："+e._s(e.candidate.count))])]),t("button",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}],staticClass:"btn btn-danger",on:{click:function(t){return e.handleDelete(e.candidate.id)}}},[e._v(" 刪除 ")])])},y=[],g={name:"MyItem",props:["candidate","checkCandidate","deleteCandidate","voteForCandidate","isAdmin"],methods:{handleCheck(e){this.checkCandidate(e)},handleDelete(e){this.isAdmin&&confirm("確定刪除嗎？")&&s.Z.delete(`/candidate/${e}`).then((()=>{this.$emit("delete",e)})).catch((e=>{console.error("刪除候選項目錯誤：",e)}))},handleVote(e){this.voteForCandidate(e)}}},k=g,A=(0,h.Z)(k,C,y,!1,null,"0e6ddefc",null),b=A.exports,_={name:"MyList",components:{MyItem:b},props:["candidates","checkCandidate","deleteCandidate","isAdmin"],data(){return{localCandidates:[...this.candidates]}},watch:{candidates(e){this.localCandidates=[...e]}},methods:{handleDelete(e){this.isAdmin&&(this.localCandidates=this.localCandidates.filter((t=>t.id!==e)))}}},w=_,x=(0,h.Z)(w,f,v,!1,null,"a863c274",null),M=x.exports,O=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.total,expression:"total"}],staticClass:"candidate-footer"},[t("label",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.person,expression:"person"}],attrs:{type:"text",placeholder:"輸入您的名稱"},domProps:{value:e.person},on:{input:function(t){t.target.composing||(e.person=t.target.value)}}})]),t("button",{staticClass:"btn btn-primary",attrs:{disabled:e.isAdmin||0===e.selectedTotal},on:{click:e.vote}},[e._v(" 投票 ")])])},Z=[],j={name:"MyFooter",props:["candidates","checkAllCandidate","clearAllCandidate","isAdmin"],data(){return{person:""}},computed:{total(){return this.candidates.length},selectedTotal(){return this.candidates.reduce(((e,t)=>e+(t.selected?1:0)),0)},isAll:{get(){return this.selectedTotal===this.total&&this.total>0},set(e){this.checkAllCandidate(e)}}},methods:{clearAll(){this.clearAllCandidate()},vote(){if(0===this.selectedTotal)return void alert("請選擇要投票的候選項目");if(!this.person.trim())return void alert("您的名稱不能為空");const e=this.candidates.filter((e=>e.selected)),t=`/candidate/update?person=${encodeURIComponent(this.person)}`;s.Z.post(t,e).then((()=>{this.candidates.forEach((e=>{e.selected&&(e.count++,e.selected=!1)})),this.person=""})).catch((e=>{console.error("投票錯誤：",e)}))}}},P=j,T=(0,h.Z)(P,O,Z,!1,null,"366f04e2",null),E=T.exports,F={name:"App",components:{MyHeader:p,MyList:M,MyFooter:E},data(){return{candidates:[],isAdmin:!1}},created(){s.Z.get("/candidate/all").then((e=>{this.candidates=e.data})).catch((e=>{console.error("獲取候選項目失敗：",e)}))},methods:{addCandidate(e){this.candidates.unshift(e)},checkCandidate(e){this.candidates.forEach((t=>{t.id===e&&(t.selected=!t.selected)}))},deleteCandidate(e){this.candidates=this.candidates.filter((t=>t.id!==e))},checkAllCandidate(e){this.candidates.forEach((t=>{t.selected=e}))},clearAllCandidate(){this.candidates=this.candidates.filter((e=>!e.selected))},toggleMode(e){this.isAdmin="管理員模式"===e}}},$=F,D=(0,h.Z)($,d,i,!1,null,null,null),I=D.exports;n.ZP.config.productionTip=!1,new n.ZP({render:e=>e(I)}).$mount("#app")}},t={};function a(n){var d=t[n];if(void 0!==d)return d.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,a),i.exports}a.m=e,function(){var e=[];a.O=function(t,n,d,i){if(!n){var s=1/0;for(l=0;l<e.length;l++){n=e[l][0],d=e[l][1],i=e[l][2];for(var r=!0,o=0;o<n.length;o++)(!1&i||s>=i)&&Object.keys(a.O).every((function(e){return a.O[e](n[o])}))?n.splice(o--,1):(r=!1,i<s&&(s=i));if(r){e.splice(l--,1);var c=d();void 0!==c&&(t=c)}}return t}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[n,d,i]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var d,i,s=n[0],r=n[1],o=n[2],c=0;if(s.some((function(t){return 0!==e[t]}))){for(d in r)a.o(r,d)&&(a.m[d]=r[d]);if(o)var l=o(a)}for(t&&t(n);c<s.length;c++)i=s[c],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return a.O(l)},n=self["webpackChunkmy_project"]=self["webpackChunkmy_project"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(9180)}));n=a.O(n)})();
//# sourceMappingURL=app.748491e9.js.map